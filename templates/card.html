<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <script type="text/javascript" src="../js/jquery-2.1.1.min.js"></script>
  <script type="text/javascript" src="../js/photobooth_min.js"></script>
  <script type="text/javascript" src="../js/jquery-ui.min.js"></script>
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" type="text/css" href="../css/ahstaffcard.css">
</head>
<body>

<div id="container" style="display:block;">
    <div class="card">
        <div class="logo"><img src = "../img/ahlogo.png" class = "logoimg" style="width: 100%"></div>
        <div class="photo"></div>
        <div id="name" class="name"></div>
        <div id="title" class="title"></div>
        <div class="barcode"><img src = "http://services.asianhope.org/idcards/barcode.php?text=123&size=30" id = "barcodeimg" alt="blah"></div>
        <div id ="barcodenumber" class="barcodenumber">123</div>
        <div class="footer"><img class="footerimg" src = "../img/ahfooter.png" style="width: 100%"/> </div>
    </div>
</div>
<div id="controls" style="position: absolute;">

<div id="photoControl" class="ui-widget-content" style="background-color:#ccc; opacity: 0.5;  width:200px; height:300px;"><div id="x-position"></div><div id="y-position"></div></div>
</div>
<div class="wr">
    <input type="image" src="../img/out.png" class="btn" onclick="deSize()"/>
    <input type="range" value="100" min="10" max="200" id="rg" class="rg" onchange="setVal()"/>
    <input type="image" src="../img/in.png" class="btn" onclick="inSize()"/>
  </div></body>
    <style media="screen">
      .wr{
        position: absolute;
        top: 370px;
      }
    </style>

<script>
    var iw;
    var ih;
    window.onload=function(){
      var image_url = $('.photo').css('background-image'),image;
      // Remove url() or in case of Chrome url("")
      image_url = image_url.match(/^url\("?(.+?)"?\)$/);
      // if (image_url[1]) {
          image_url = image_url[1];
          image = new Image();
          // just in case it is not already loaded
          $(image).load(function () {
              iw = image.width;
              ih = image.height;
              var i = document.getElementById("rg").value;
              image.style.transition = "All linear 0.5s";
               $('.photo').css({
                'background-size':parseInt(iw*i/100)+'px ' +parseInt(ih*i/100)+'px'
              });
               console.log(iw+".."+ih);
                console.log(parseInt(iw*i/100)+".."+parseInt(ih*i/100));

              });
              image.src = image_url;
        };
        function setVal()
        {
          var img = new Image;
          img.src = $('.photo').css('background-image').replace(/url\(|\)$/ig, "");
          var i = document.getElementById("rg").value;
          $('.photo').css({
            'background-size':parseInt(iw*i/100)+'px ' +parseInt(ih*i/100)+'px'
          });

        }
      function deSize()
      {
        var img = new Image;
        img.src = $('.photo').css('background-image').replace(/url\(|\)$/ig, "");
        var i = document.getElementById("rg").value-5;
        document.getElementById("rg").value=i;
          if(i>=10){
              $('.photo').css({
                'background-size':parseInt(iw*i/100)+'px ' +parseInt(ih*i/100)+'px'
              });
          }

        }
      function inSize()
      {
        var img = new Image;
        img.src = $('.photo').css('background-image').replace(/url\(|\)$/ig, "");
        var i = parseInt(document.getElementById("rg").value) + 5;
        document.getElementById("rg").value=i;
        if(i<=1000){
          $('.photo').css({
          'background-size':parseInt(iw*i/100)+'px ' +parseInt(ih*i/100)+'px'
          });
        }
      }
  </script>
<script type='text/javascript'>
  $(function() {

      var bcurl = "http://services.asianhope.org/idcards/barcode.php";
      var bcsize = 30;
      var name = getParameterByName('name');
      var id = getParameterByName('id');
      var title = getParameterByName('title');
      var department = getParameterByName('department');
      document.getElementById("name").innerHTML = name;
      document.getElementById("title").innerHTML = title;
      document.getElementById("barcodenumber").innerHTML=id;
      $(".photo").css("background-image", "url('../files/"+id+".jpg')");
      $('.barcode').html('<img src="'+bcurl+'?text='+id+'&size='+bcsize+'"/>');
      $('link').attr('href','../css/ahstaffcard.css');
      $('.footerimg').attr('src','../img/ahfooter.png');
      $('.logoimg').attr('src','../img/ahlogo.png');
      if(department=="LIS"){
        console.log(department);
        $('link').attr('href','../css/staffcard.css');
        $('.footerimg').attr('src','../img/logosfooter.png');
        $('.logoimg').attr('src','../img/logoslogo.png');
      }
      function getParameterByName(name) {
          name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
          var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
              results = regex.exec(location.search);
          return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
      }
      $('#photoControl').draggable({
          drag: function(){
             var position = $(this).position()
             $('.photo').css('background-position',position.left+'px '+position.top+'px');
             console.log($(this).position());
          }
      });
    });

</script>

</html>
