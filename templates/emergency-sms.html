<div class="table-responsive" ng-controller="TabController as tab">
  <h3>Emergency SMS</h3> <span style="color:red;" ng-if="sendMessageSMS">{{sendMessageSMS}}</span>
  <div ng-if="invalid_mobiles" style="color:red;">
    Note : SMS cannot send to invalid phone number format
    <button ng-click="continuesSendSmsUsers()" class="btn btn-warning">Continues</button>

    <ul style="color:red;">
      <li ng-repeat="invalid in invalid_mobiles">Employee : {{invalid.name}} , Mobile : {{invalid.mobile}}</li>
    </ul>
  </div>
  <form role="form" name="sendSMS">
    <div class="form-group">
      <label>SMS Text</label>
      <textarea class="form-control" rows="5" ng-model="message.value" maxlength="160" id="messageSMS" ng-keyup="count_characters()" required></textarea>
    </div>
    <div class="from-group" style="font-size:20px;">
      <div class="col-md-6" style="text-align:left;">
        Total cost to send:
        <span ng-if="this.tab.isSet(3)">
          {{totalCostUsers | currency}}
        </span>
        <span ng-if="this.tab.isSet(4)">
          {{totalCostMails | currency}}
        </span>
      </div>
      <div class="col-md-6" style="text-align:right;">{{character_typed}}/{{characters_max}}</div>
    </div>
    <div style="text-align:right;" class="form-group" ng-if="this.tab.isSet(3)">
      <button type='button' ng-disabled="sendSMS.$invalid || selected_people_users < 1" ng-click="sendSMSUsers()" class="btn btn-primary">Send SMS to {{selected_people_users}} people</button>
    </div>
    <div style="text-align: right;" class="form-group" ng-if="this.tab.isSet(4)">
      <button ng-disabled="sendSMS.$invalid || selected_people_mail_list < 1" type='button' ng-click="sendSMSMails()" class="btn btn-primary">Send SMS to {{selected_people_mail_list}} people</button>
    </div>
  <div class="row mdl-tabs mdl-js-tabs">
    <div class="mdl-tabs__tab-bar" style="margin-bottom:20px;">
      <a href ng-click="this.tab.setTab(3)" ng-class="{tab_active : this.tab.isSet(3)}" class="mdl-tabs__tab">Users</a>
      <a href ng-click="this.tab.setTab(4)" ng-class="{tab_active : this.tab.isSet(4)}" class="mdl-tabs__tab">Mailing Lists</a>
    </div>
  </div>
  <div class="" ng-show="this.tab.isSet(3)">
    <div style="text-align:right">
      <input placeholder="Search..." class="searchbox_send_sms" type="text" ng-model="search_send_sms.search_user" ng-keyup="clearSearchUser()"/>
    </div>
    <div>
      <table id="tbl_users" datatable="ng" dt-options="elist.dtOptionsSelect" style="width:100%; margin-top:10px;" class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">
        <thead>
          <tr>
            <th><input type="checkbox" ng-model="check_all.users" ng-change="checkAllUsers((employees_users | filter : search_send_sms.search_user))" /></th>
            <th>ID</th><th>Dept</th><th>Name</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="employee in employees_users | filter : search_send_sms.search_user" ng-class="{selected_row : employee.selected_user == true , invalid_phone_number : !isPhoneNumberValid(employee.mobile)}">
            <td>
              <input type="checkbox" ng-change="change_user_select((employees_users | filter : search_send_sms.search_user))" ng-model="employee.selected_user"/>
            </td>
            <td><a ui-sref="admin.staff({instanceID:employee.employeeNumber})">{{employee.employeeNumber}}</a></td>
            <td>{{employee.departmentNumber}}</td>
            <td>{{employee.givenName}} {{employee.sn}}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div ng-show="this.tab.isSet(4)">
    <div style="text-align:right">
      <input type="text" class="searchbox_send_sms" placeholder="Search..." ng-model="search_send_sms.search_mail" ng-keyup="clearSearchMail()"/>
    </div>
    <div>
      <table datatable="ng" dt-options="elist.dtOptionsSelect" style="width:100%; margin-top:10px;" class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">
        <thead>
          <tr>
            <th><input type="checkbox" ng-model="check_all.mails" ng-change="checkAllMails((groups | filter : search_send_sms.search_mail))"/></th>
            <th>Group Name</th><th>Mail</th><th>Member</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="group in groups | filter : search_send_sms.search_mail" ng-class="{selected_row : group.selected_mail == true}">
            <td>
              <input type="checkbox" ng-model="group.selected_mail" ng-change="change_mail_select((groups | filter : search_send_sms.search_mail))"/>
            </td>
            <td>{{group.displayName}}</td>
            <td>{{group.mail}}</td>
            <td>
                {{group.memberUid.length}}
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</form>
</div>
